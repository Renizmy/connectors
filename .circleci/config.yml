version: 2.1

jobs:

  build_external-import:
    docker:
      - image: cimg/base:stable-20.04
    steps:
      - checkout

      - run:
          name: Build external-import/comlaude
          command: |
            echo "Processing external-import/comlaude"
            cd external-import/comlaude
            echo "$DOCKERHUB_USERNAME"
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-comlaude:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-comlaude:latest
            docker push opencti/connector-comlaude:6.4.1
            docker push opencti/connector-comlaude:latest

      
      - run:
          name: Build external-import/shadowserver
          command: |
            echo "Processing external-import/shadowserver"
            cd external-import/shadowserver
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-shadowserver:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-shadowserver:latest
            docker push opencti/connector-shadowserver:6.4.1
            docker push opencti/connector-shadowserver:latest

      
      - run:
          name: Build external-import/tweetfeed
          command: |
            echo "Processing external-import/tweetfeed"
            cd external-import/tweetfeed
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-tweetfeed:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-tweetfeed:latest
            docker push opencti/connector-tweetfeed:6.4.1
            docker push opencti/connector-tweetfeed:latest

      
      - run:
          name: Build external-import/lastinfosec
          command: |
            echo "Processing external-import/lastinfosec"
            cd external-import/lastinfosec
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-lastinfosec:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-lastinfosec:latest
            docker push opencti/connector-lastinfosec:6.4.1
            docker push opencti/connector-lastinfosec:latest

      
      - run:
          name: Build external-import/sentinelone-threats
          command: |
            echo "Processing external-import/sentinelone-threats"
            cd external-import/sentinelone-threats
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-sentinelone-threats:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-sentinelone-threats:latest
            docker push opencti/connector-sentinelone-threats:6.4.1
            docker push opencti/connector-sentinelone-threats:latest

      
      - run:
          name: Build external-import/citalid
          command: |
            echo "Processing external-import/citalid"
            cd external-import/citalid
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-citalid:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-citalid:latest
            docker push opencti/connector-citalid:6.4.1
            docker push opencti/connector-citalid:latest

      
      - run:
          name: Build external-import/malcore
          command: |
            echo "Processing external-import/malcore"
            cd external-import/malcore
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-malcore:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-malcore:latest
            docker push opencti/connector-malcore:6.4.1
            docker push opencti/connector-malcore:latest

      
      - run:
          name: Build external-import/rst-report-hub
          command: |
            echo "Processing external-import/rst-report-hub"
            cd external-import/rst-report-hub
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-rst-report-hub:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-rst-report-hub:latest
            docker push opencti/connector-rst-report-hub:6.4.1
            docker push opencti/connector-rst-report-hub:latest

      
      - run:
          name: Build external-import/malpedia
          command: |
            echo "Processing external-import/malpedia"
            cd external-import/malpedia
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-malpedia:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-malpedia:latest
            docker push opencti/connector-malpedia:6.4.1
            docker push opencti/connector-malpedia:latest

      
      - run:
          name: Build external-import/cyber-campaign-collection
          command: |
            echo "Processing external-import/cyber-campaign-collection"
            cd external-import/cyber-campaign-collection
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cyber-campaign-collection:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cyber-campaign-collection:latest
            docker push opencti/connector-cyber-campaign-collection:6.4.1
            docker push opencti/connector-cyber-campaign-collection:latest

      
      - run:
          name: Build external-import/abuse-ssl
          command: |
            echo "Processing external-import/abuse-ssl"
            cd external-import/abuse-ssl
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-abuse-ssl:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-abuse-ssl:latest
            docker push opencti/connector-abuse-ssl:6.4.1
            docker push opencti/connector-abuse-ssl:latest

      
      - run:
          name: Build external-import/urlhaus-recent-payloads
          command: |
            echo "Processing external-import/urlhaus-recent-payloads"
            cd external-import/urlhaus-recent-payloads
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-urlhaus-recent-payloads:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-urlhaus-recent-payloads:latest
            docker push opencti/connector-urlhaus-recent-payloads:6.4.1
            docker push opencti/connector-urlhaus-recent-payloads:latest

      
      - run:
          name: Build external-import/crits
          command: |
            echo "Processing external-import/crits"
            cd external-import/crits
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-crits:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-crits:latest
            docker push opencti/connector-crits:6.4.1
            docker push opencti/connector-crits:latest

      
      - run:
          name: Build external-import/sentinel-incidents
          command: |
            echo "Processing external-import/sentinel-incidents"
            cd external-import/sentinel-incidents
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-sentinel-incidents:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-sentinel-incidents:latest
            docker push opencti/connector-sentinel-incidents:6.4.1
            docker push opencti/connector-sentinel-incidents:latest

      
      - run:
          name: Build external-import/urlhaus
          command: |
            echo "Processing external-import/urlhaus"
            cd external-import/urlhaus
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-urlhaus:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-urlhaus:latest
            docker push opencti/connector-urlhaus:6.4.1
            docker push opencti/connector-urlhaus:latest

      
      - run:
          name: Build external-import/mwdb
          command: |
            echo "Processing external-import/mwdb"
            cd external-import/mwdb
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-mwdb:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-mwdb:latest
            docker push opencti/connector-mwdb:6.4.1
            docker push opencti/connector-mwdb:latest

      
      - run:
          name: Build external-import/cve
          command: |
            echo "Processing external-import/cve"
            cd external-import/cve
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cve:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cve:latest
            docker push opencti/connector-cve:6.4.1
            docker push opencti/connector-cve:latest

      
      - run:
          name: Build external-import/malwarebazaar-recent-additions
          command: |
            echo "Processing external-import/malwarebazaar-recent-additions"
            cd external-import/malwarebazaar-recent-additions
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-malwarebazaar-recent-additions:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-malwarebazaar-recent-additions:latest
            docker push opencti/connector-malwarebazaar-recent-additions:6.4.1
            docker push opencti/connector-malwarebazaar-recent-additions:latest

      
      - run:
          name: Build external-import/mandiant
          command: |
            echo "Processing external-import/mandiant"
            cd external-import/mandiant
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-mandiant:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-mandiant:latest
            docker push opencti/connector-mandiant:6.4.1
            docker push opencti/connector-mandiant:latest

      
      - run:
          name: Build external-import/cybersixgill
          command: |
            echo "Processing external-import/cybersixgill"
            cd external-import/cybersixgill
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cybersixgill:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cybersixgill:latest
            docker push opencti/connector-cybersixgill:6.4.1
            docker push opencti/connector-cybersixgill:latest

      
      - run:
          name: Build external-import/phishunt
          command: |
            echo "Processing external-import/phishunt"
            cd external-import/phishunt
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-phishunt:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-phishunt:latest
            docker push opencti/connector-phishunt:6.4.1
            docker push opencti/connector-phishunt:latest

      
      - run:
          name: Build external-import/disarm-framework
          command: |
            echo "Processing external-import/disarm-framework"
            cd external-import/disarm-framework
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-disarm-framework:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-disarm-framework:latest
            docker push opencti/connector-disarm-framework:6.4.1
            docker push opencti/connector-disarm-framework:latest

      
      - run:
          name: Build external-import/opencsam
          command: |
            echo "Processing external-import/opencsam"
            cd external-import/opencsam
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-opencsam:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-opencsam:latest
            docker push opencti/connector-opencsam:6.4.1
            docker push opencti/connector-opencsam:latest

      
      - run:
          name: Build external-import/crowdstrike
          command: |
            echo "Processing external-import/crowdstrike"
            cd external-import/crowdstrike
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-crowdstrike:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-crowdstrike:latest
            docker push opencti/connector-crowdstrike:6.4.1
            docker push opencti/connector-crowdstrike:latest

      
      - run:
          name: Build external-import/cisa-known-exploited-vulnerabilities
          command: |
            echo "Processing external-import/cisa-known-exploited-vulnerabilities"
            cd external-import/cisa-known-exploited-vulnerabilities
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cisa-known-exploited-vulnerabilities:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cisa-known-exploited-vulnerabilities:latest
            docker push opencti/connector-cisa-known-exploited-vulnerabilities:6.4.1
            docker push opencti/connector-cisa-known-exploited-vulnerabilities:latest

      
      - run:
          name: Build external-import/opencti
          command: |
            echo "Processing external-import/opencti"
            cd external-import/opencti
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-opencti:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-opencti:latest
            docker push opencti/connector-opencti:6.4.1
            docker push opencti/connector-opencti:latest

      
      - run:
          name: Build external-import/cluster25
          command: |
            echo "Processing external-import/cluster25"
            cd external-import/cluster25
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cluster25:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cluster25:latest
            docker push opencti/connector-cluster25:6.4.1
            docker push opencti/connector-cluster25:latest

      
      - run:
          name: Build external-import/maltiverse
          command: |
            echo "Processing external-import/maltiverse"
            cd external-import/maltiverse
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-maltiverse:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-maltiverse:latest
            docker push opencti/connector-maltiverse:6.4.1
            docker push opencti/connector-maltiverse:latest

      
      - run:
          name: Build external-import/threatfox
          command: |
            echo "Processing external-import/threatfox"
            cd external-import/threatfox
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-threatfox:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-threatfox:latest
            docker push opencti/connector-threatfox:6.4.1
            docker push opencti/connector-threatfox:latest

      
      - run:
          name: Build external-import/taxii2
          command: |
            echo "Processing external-import/taxii2"
            cd external-import/taxii2
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-taxii2:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-taxii2:latest
            docker push opencti/connector-taxii2:6.4.1
            docker push opencti/connector-taxii2:latest

      
      - run:
          name: Build external-import/thehive
          command: |
            echo "Processing external-import/thehive"
            cd external-import/thehive
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-thehive:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-thehive:latest
            docker push opencti/connector-thehive:6.4.1
            docker push opencti/connector-thehive:latest

      
      - run:
          name: Build external-import/google-drive
          command: |
            echo "Processing external-import/google-drive"
            cd external-import/google-drive
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-google-drive:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-google-drive:latest
            docker push opencti/connector-google-drive:6.4.1
            docker push opencti/connector-google-drive:latest

      
      - run:
          name: Build external-import/cisco-sma
          command: |
            echo "Processing external-import/cisco-sma"
            cd external-import/cisco-sma
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cisco-sma:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cisco-sma:latest
            docker push opencti/connector-cisco-sma:6.4.1
            docker push opencti/connector-cisco-sma:latest

      
      - run:
          name: Build external-import/valhalla
          command: |
            echo "Processing external-import/valhalla"
            cd external-import/valhalla
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-valhalla:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-valhalla:latest
            docker push opencti/connector-valhalla:6.4.1
            docker push opencti/connector-valhalla:latest

      
      - run:
          name: Build external-import/kaspersky
          command: |
            echo "Processing external-import/kaspersky"
            cd external-import/kaspersky
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-kaspersky:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-kaspersky:latest
            docker push opencti/connector-kaspersky:6.4.1
            docker push opencti/connector-kaspersky:latest

      
      - run:
          name: Build external-import/obstracts
          command: |
            echo "Processing external-import/obstracts"
            cd external-import/obstracts
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-obstracts:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-obstracts:latest
            docker push opencti/connector-obstracts:6.4.1
            docker push opencti/connector-obstracts:latest

      
      - run:
          name: Build external-import/red-flag-domains
          command: |
            echo "Processing external-import/red-flag-domains"
            cd external-import/red-flag-domains
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-red-flag-domains:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-red-flag-domains:latest
            docker push opencti/connector-red-flag-domains:6.4.1
            docker push opencti/connector-red-flag-domains:latest

      
      - run:
          name: Build external-import/stopforumspam
          command: |
            echo "Processing external-import/stopforumspam"
            cd external-import/stopforumspam
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-stopforumspam:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-stopforumspam:latest
            docker push opencti/connector-stopforumspam:6.4.1
            docker push opencti/connector-stopforumspam:latest

      
      - run:
          name: Build external-import/flashpoint
          command: |
            echo "Processing external-import/flashpoint"
            cd external-import/flashpoint
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-flashpoint:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-flashpoint:latest
            docker push opencti/connector-flashpoint:6.4.1
            docker push opencti/connector-flashpoint:latest

      
      - run:
          name: Build external-import/mitre-atlas
          command: |
            echo "Processing external-import/mitre-atlas"
            cd external-import/mitre-atlas
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-mitre-atlas:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-mitre-atlas:latest
            docker push opencti/connector-mitre-atlas:6.4.1
            docker push opencti/connector-mitre-atlas:latest

      
      - run:
          name: Build external-import/chapsvision
          command: |
            echo "Processing external-import/chapsvision"
            cd external-import/chapsvision
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-chapsvision:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-chapsvision:latest
            docker push opencti/connector-chapsvision:6.4.1
            docker push opencti/connector-chapsvision:latest

      
      - run:
          name: Build external-import/fortinet-ti
          command: |
            echo "Processing external-import/fortinet-ti"
            cd external-import/fortinet-ti
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-fortinet-ti:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-fortinet-ti:latest
            docker push opencti/connector-fortinet-ti:6.4.1
            docker push opencti/connector-fortinet-ti:latest

      
      - run:
          name: Build external-import/tanium-incidents
          command: |
            echo "Processing external-import/tanium-incidents"
            cd external-import/tanium-incidents
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-tanium-incidents:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-tanium-incidents:latest
            docker push opencti/connector-tanium-incidents:6.4.1
            docker push opencti/connector-tanium-incidents:latest

      
      - run:
          name: Build external-import/tenable-vuln-management
          command: |
            echo "Processing external-import/tenable-vuln-management"
            cd external-import/tenable-vuln-management
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-tenable-vuln-management:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-tenable-vuln-management:latest
            docker push opencti/connector-tenable-vuln-management:6.4.1
            docker push opencti/connector-tenable-vuln-management:latest

      
      - run:
          name: Build external-import/intelfinder
          command: |
            echo "Processing external-import/intelfinder"
            cd external-import/intelfinder
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-intelfinder:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-intelfinder:latest
            docker push opencti/connector-intelfinder:6.4.1
            docker push opencti/connector-intelfinder:latest

      
      - run:
          name: Build external-import/intel471
          command: |
            echo "Processing external-import/intel471"
            cd external-import/intel471
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-intel471:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-intel471:latest
            docker push opencti/connector-intel471:6.4.1
            docker push opencti/connector-intel471:latest

      
      - run:
          name: Build external-import/misp
          command: |
            echo "Processing external-import/misp"
            cd external-import/misp
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-misp:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-misp:latest
            docker push opencti/connector-misp:6.4.1
            docker push opencti/connector-misp:latest

      
      - run:
          name: Build external-import/misp-feed
          command: |
            echo "Processing external-import/misp-feed"
            cd external-import/misp-feed
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-misp-feed:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-misp-feed:latest
            docker push opencti/connector-misp-feed:6.4.1
            docker push opencti/connector-misp-feed:latest

      
      - run:
          name: Build external-import/eset
          command: |
            echo "Processing external-import/eset"
            cd external-import/eset
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-eset:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-eset:latest
            docker push opencti/connector-eset:6.4.1
            docker push opencti/connector-eset:latest

      
      - run:
          name: Build external-import/greynoise-feed
          command: |
            echo "Processing external-import/greynoise-feed"
            cd external-import/greynoise-feed
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-greynoise-feed:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-greynoise-feed:latest
            docker push opencti/connector-greynoise-feed:6.4.1
            docker push opencti/connector-greynoise-feed:latest

      
      - run:
          name: Build external-import/recorded-future
          command: |
            echo "Processing external-import/recorded-future"
            cd external-import/recorded-future
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-recorded-future:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-recorded-future:latest
            docker push opencti/connector-recorded-future:6.4.1
            docker push opencti/connector-recorded-future:latest

      
      - run:
          name: Build external-import/riskiq
          command: |
            echo "Processing external-import/riskiq"
            cd external-import/riskiq
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-riskiq:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-riskiq:latest
            docker push opencti/connector-riskiq:6.4.1
            docker push opencti/connector-riskiq:latest

      
      - run:
          name: Build external-import/group-ib
          command: |
            echo "Processing external-import/group-ib"
            cd external-import/group-ib
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-group-ib:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-group-ib:latest
            docker push opencti/connector-group-ib:6.4.1
            docker push opencti/connector-group-ib:latest

      
      - run:
          name: Build external-import/harfanglab-incidents
          command: |
            echo "Processing external-import/harfanglab-incidents"
            cd external-import/harfanglab-incidents
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-harfanglab-incidents:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-harfanglab-incidents:latest
            docker push opencti/connector-harfanglab-incidents:6.4.1
            docker push opencti/connector-harfanglab-incidents:latest

      
      - run:
          name: Build external-import/silobreaker
          command: |
            echo "Processing external-import/silobreaker"
            cd external-import/silobreaker
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-silobreaker:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-silobreaker:latest
            docker push opencti/connector-silobreaker:6.4.1
            docker push opencti/connector-silobreaker:latest

      
      - run:
          name: Build external-import/alienvault
          command: |
            echo "Processing external-import/alienvault"
            cd external-import/alienvault
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-alienvault:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-alienvault:latest
            docker push opencti/connector-alienvault:6.4.1
            docker push opencti/connector-alienvault:latest

      
      - run:
          name: Build external-import/zerofox
          command: |
            echo "Processing external-import/zerofox"
            cd external-import/zerofox
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-zerofox:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-zerofox:latest
            docker push opencti/connector-zerofox:6.4.1
            docker push opencti/connector-zerofox:latest

      
      - run:
          name: Build external-import/cuckoo
          command: |
            echo "Processing external-import/cuckoo"
            cd external-import/cuckoo
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cuckoo:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cuckoo:latest
            docker push opencti/connector-cuckoo:6.4.1
            docker push opencti/connector-cuckoo:latest

      
      - run:
          name: Build external-import/cpe
          command: |
            echo "Processing external-import/cpe"
            cd external-import/cpe
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cpe:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cpe:latest
            docker push opencti/connector-cpe:6.4.1
            docker push opencti/connector-cpe:latest

      
      - run:
          name: Build external-import/restore-files
          command: |
            echo "Processing external-import/restore-files"
            cd external-import/restore-files
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-restore-files:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-restore-files:latest
            docker push opencti/connector-restore-files:6.4.1
            docker push opencti/connector-restore-files:latest

      
      - run:
          name: Build external-import/stixify
          command: |
            echo "Processing external-import/stixify"
            cd external-import/stixify
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-stixify:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-stixify:latest
            docker push opencti/connector-stixify:6.4.1
            docker push opencti/connector-stixify:latest

      
      - run:
          name: Build external-import/orange-cyberdefense
          command: |
            echo "Processing external-import/orange-cyberdefense"
            cd external-import/orange-cyberdefense
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-orange-cyberdefense:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-orange-cyberdefense:latest
            docker push opencti/connector-orange-cyberdefense:6.4.1
            docker push opencti/connector-orange-cyberdefense:latest

      
      - run:
          name: Build external-import/abuseipdb-ipblacklist
          command: |
            echo "Processing external-import/abuseipdb-ipblacklist"
            cd external-import/abuseipdb-ipblacklist
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-abuseipdb-ipblacklist:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-abuseipdb-ipblacklist:latest
            docker push opencti/connector-abuseipdb-ipblacklist:6.4.1
            docker push opencti/connector-abuseipdb-ipblacklist:latest

      
      - run:
          name: Build external-import/sekoia
          command: |
            echo "Processing external-import/sekoia"
            cd external-import/sekoia
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-sekoia:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-sekoia:latest
            docker push opencti/connector-sekoia:6.4.1
            docker push opencti/connector-sekoia:latest

      
      - run:
          name: Build external-import/vxvault
          command: |
            echo "Processing external-import/vxvault"
            cd external-import/vxvault
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-vxvault:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-vxvault:latest
            docker push opencti/connector-vxvault:6.4.1
            docker push opencti/connector-vxvault:latest

      
      - run:
          name: Build external-import/mitre
          command: |
            echo "Processing external-import/mitre"
            cd external-import/mitre
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-mitre:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-mitre:latest
            docker push opencti/connector-mitre:6.4.1
            docker push opencti/connector-mitre:latest

      
      - run:
          name: Build external-import/crtsh
          command: |
            echo "Processing external-import/crtsh"
            cd external-import/crtsh
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-crtsh:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-crtsh:latest
            docker push opencti/connector-crtsh:6.4.1
            docker push opencti/connector-crtsh:latest

      
      - run:
          name: Build external-import/virustotal-livehunt-notifications
          command: |
            echo "Processing external-import/virustotal-livehunt-notifications"
            cd external-import/virustotal-livehunt-notifications
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-virustotal-livehunt-notifications:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-virustotal-livehunt-notifications:latest
            docker push opencti/connector-virustotal-livehunt-notifications:6.4.1
            docker push opencti/connector-virustotal-livehunt-notifications:latest

      
      - run:
          name: Build external-import/infoblox
          command: |
            echo "Processing external-import/infoblox"
            cd external-import/infoblox
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-infoblox:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-infoblox:latest
            docker push opencti/connector-infoblox:6.4.1
            docker push opencti/connector-infoblox:latest

      
      - run:
          name: Build external-import/cofense
          command: |
            echo "Processing external-import/cofense"
            cd external-import/cofense
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cofense:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cofense:latest
            docker push opencti/connector-cofense:6.4.1
            docker push opencti/connector-cofense:latest

      
      - run:
          name: Build external-import/rst-threat-feed
          command: |
            echo "Processing external-import/rst-threat-feed"
            cd external-import/rst-threat-feed
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-rst-threat-feed:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-rst-threat-feed:latest
            docker push opencti/connector-rst-threat-feed:6.4.1
            docker push opencti/connector-rst-threat-feed:latest

      
      - run:
          name: Build external-import/siemrules
          command: |
            echo "Processing external-import/siemrules"
            cd external-import/siemrules
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-siemrules:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-siemrules:latest
            docker push opencti/connector-siemrules:6.4.1
            docker push opencti/connector-siemrules:latest

      
      - run:
          name: Build external-import/cape
          command: |
            echo "Processing external-import/cape"
            cd external-import/cape
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-cape:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-cape:latest
            docker push opencti/connector-cape:6.4.1
            docker push opencti/connector-cape:latest

      
      - run:
          name: Build external-import/ironnet
          command: |
            echo "Processing external-import/ironnet"
            cd external-import/ironnet
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-ironnet:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-ironnet:latest
            docker push opencti/connector-ironnet:6.4.1
            docker push opencti/connector-ironnet:latest

      
      - run:
          name: Build external-import/urlscan
          command: |
            echo "Processing external-import/urlscan"
            cd external-import/urlscan
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-urlscan:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-urlscan:latest
            docker push opencti/connector-urlscan:6.4.1
            docker push opencti/connector-urlscan:latest

      
      - run:
          name: Build external-import/anyrun-feed
          command: |
            echo "Processing external-import/anyrun-feed"
            cd external-import/anyrun-feed
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-anyrun-feed:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-anyrun-feed:latest
            docker push opencti/connector-anyrun-feed:6.4.1
            docker push opencti/connector-anyrun-feed:latest

      
      - run:
          name: Build external-import/ransomwarelive
          command: |
            echo "Processing external-import/ransomwarelive"
            cd external-import/ransomwarelive
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-ransomwarelive:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-ransomwarelive:latest
            docker push opencti/connector-ransomwarelive:6.4.1
            docker push opencti/connector-ransomwarelive:latest

      
      - run:
          name: Build external-import/feedly
          command: |
            echo "Processing external-import/feedly"
            cd external-import/feedly
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-feedly:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-feedly:latest
            docker push opencti/connector-feedly:6.4.1
            docker push opencti/connector-feedly:latest

      
      - run:
          name: Build external-import/socprime
          command: |
            echo "Processing external-import/socprime"
            cd external-import/socprime
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-socprime:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-socprime:latest
            docker push opencti/connector-socprime:6.4.1
            docker push opencti/connector-socprime:latest

      
      - run:
          name: Build external-import/diode-import
          command: |
            echo "Processing external-import/diode-import"
            cd external-import/diode-import
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-diode-import:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-diode-import:latest
            docker push opencti/connector-diode-import:6.4.1
            docker push opencti/connector-diode-import:latest

      
      - run:
          name: Build external-import/threatmatch
          command: |
            echo "Processing external-import/threatmatch"
            cd external-import/threatmatch
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-threatmatch:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-threatmatch:latest
            docker push opencti/connector-threatmatch:6.4.1
            docker push opencti/connector-threatmatch:latest

      
      - run:
          name: Build external-import/vulmatch
          command: |
            echo "Processing external-import/vulmatch"
            cd external-import/vulmatch
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-vulmatch:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-vulmatch:latest
            docker push opencti/connector-vulmatch:6.4.1
            docker push opencti/connector-vulmatch:latest

      

  build_stream:
    docker:
      - image: cimg/base:stable-20.04
    steps:
      - checkout
      
      - run:
          name: Build stream/harfanglab-intel
          command: |
            echo "Processing stream/harfanglab-intel"
            cd stream/harfanglab-intel
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-harfanglab-intel:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-harfanglab-intel:latest
            docker push opencti/connector-harfanglab-intel:6.4.1
            docker push opencti/connector-harfanglab-intel:latest

      
      - run:
          name: Build stream/crowdstrike-endpoint-security
          command: |
            echo "Processing stream/crowdstrike-endpoint-security"
            cd stream/crowdstrike-endpoint-security
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-crowdstrike-endpoint-security:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-crowdstrike-endpoint-security:latest
            docker push opencti/connector-crowdstrike-endpoint-security:6.4.1
            docker push opencti/connector-crowdstrike-endpoint-security:latest

      
      - run:
          name: Build stream/webhook
          command: |
            echo "Processing stream/webhook"
            cd stream/webhook
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-webhook:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-webhook:latest
            docker push opencti/connector-webhook:6.4.1
            docker push opencti/connector-webhook:latest

      
      - run:
          name: Build stream/splunk
          command: |
            echo "Processing stream/splunk"
            cd stream/splunk
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-splunk:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-splunk:latest
            docker push opencti/connector-splunk:6.4.1
            docker push opencti/connector-splunk:latest

      
      - run:
          name: Build stream/sentinel-intel
          command: |
            echo "Processing stream/sentinel-intel"
            cd stream/sentinel-intel
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-sentinel-intel:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-sentinel-intel:latest
            docker push opencti/connector-sentinel-intel:6.4.1
            docker push opencti/connector-sentinel-intel:latest

      
      - run:
          name: Build stream/qradar
          command: |
            echo "Processing stream/qradar"
            cd stream/qradar
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-qradar:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-qradar:latest
            docker push opencti/connector-qradar:6.4.1
            docker push opencti/connector-qradar:latest

      
      - run:
          name: Build stream/harfanglab
          command: |
            echo "Processing stream/harfanglab"
            cd stream/harfanglab
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-harfanglab:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-harfanglab:latest
            docker push opencti/connector-harfanglab:6.4.1
            docker push opencti/connector-harfanglab:latest

      
      - run:
          name: Build stream/virustotal-livehunt-rules
          command: |
            echo "Processing stream/virustotal-livehunt-rules"
            cd stream/virustotal-livehunt-rules
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-virustotal-livehunt-rules:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-virustotal-livehunt-rules:latest
            docker push opencti/connector-virustotal-livehunt-rules:6.4.1
            docker push opencti/connector-virustotal-livehunt-rules:latest

      
      - run:
          name: Build stream/backup-files
          command: |
            echo "Processing stream/backup-files"
            cd stream/backup-files
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-backup-files:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-backup-files:latest
            docker push opencti/connector-backup-files:6.4.1
            docker push opencti/connector-backup-files:latest

      
      - run:
          name: Build stream/logrhythm
          command: |
            echo "Processing stream/logrhythm"
            cd stream/logrhythm
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-logrhythm:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-logrhythm:latest
            docker push opencti/connector-logrhythm:6.4.1
            docker push opencti/connector-logrhythm:latest

      
      - run:
          name: Build stream/taxii-post
          command: |
            echo "Processing stream/taxii-post"
            cd stream/taxii-post
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-taxii-post:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-taxii-post:latest
            docker push opencti/connector-taxii-post:6.4.1
            docker push opencti/connector-taxii-post:latest

      
      - run:
          name: Build stream/tanium
          command: |
            echo "Processing stream/tanium"
            cd stream/tanium
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-tanium:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-tanium:latest
            docker push opencti/connector-tanium:6.4.1
            docker push opencti/connector-tanium:latest

      
      - run:
          name: Build stream/chronicle
          command: |
            echo "Processing stream/chronicle"
            cd stream/chronicle
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-chronicle:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-chronicle:latest
            docker push opencti/connector-chronicle:6.4.1
            docker push opencti/connector-chronicle:latest

      
      - run:
          name: Build stream/jira
          command: |
            echo "Processing stream/jira"
            cd stream/jira
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-jira:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-jira:latest
            docker push opencti/connector-jira:6.4.1
            docker push opencti/connector-jira:latest

      
      - run:
          name: Build stream/elastic
          command: |
            echo "Processing stream/elastic"
            cd stream/elastic
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-elastic:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-elastic:latest
            docker push opencti/connector-elastic:6.4.1
            docker push opencti/connector-elastic:latest

      
      - run:
          name: Build stream/sentinel
          command: |
            echo "Processing stream/sentinel"
            cd stream/sentinel
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-sentinel:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-sentinel:latest
            docker push opencti/connector-sentinel:6.4.1
            docker push opencti/connector-sentinel:latest

      
      - run:
          name: Build stream/tanium-intel
          command: |
            echo "Processing stream/tanium-intel"
            cd stream/tanium-intel
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-tanium-intel:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-tanium-intel:latest
            docker push opencti/connector-tanium-intel:6.4.1
            docker push opencti/connector-tanium-intel:latest

      

  build_internal-export-file:
    docker:
      - image: cimg/base:stable-20.04
    steps:
      - checkout
      
      - run:
          name: Build internal-export-file/export-ttps-file-navigator
          command: |
            echo "Processing internal-export-file/export-ttps-file-navigator"
            cd internal-export-file/export-ttps-file-navigator
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-export-ttps-file-navigator:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-export-ttps-file-navigator:latest
            docker push opencti/connector-export-ttps-file-navigator:6.4.1
            docker push opencti/connector-export-ttps-file-navigator:latest

      
      - run:
          name: Build internal-export-file/export-report-pdf
          command: |
            echo "Processing internal-export-file/export-report-pdf"
            cd internal-export-file/export-report-pdf
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-export-report-pdf:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-export-report-pdf:latest
            docker push opencti/connector-export-report-pdf:6.4.1
            docker push opencti/connector-export-report-pdf:latest

      
      - run:
          name: Build internal-export-file/export-file-txt
          command: |
            echo "Processing internal-export-file/export-file-txt"
            cd internal-export-file/export-file-txt
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-export-file-txt:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-export-file-txt:latest
            docker push opencti/connector-export-file-txt:6.4.1
            docker push opencti/connector-export-file-txt:latest

      
      - run:
          name: Build internal-export-file/export-file-csv
          command: |
            echo "Processing internal-export-file/export-file-csv"
            cd internal-export-file/export-file-csv
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-export-file-csv:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-export-file-csv:latest
            docker push opencti/connector-export-file-csv:6.4.1
            docker push opencti/connector-export-file-csv:latest

      
      - run:
          name: Build internal-export-file/export-file-stix
          command: |
            echo "Processing internal-export-file/export-file-stix"
            cd internal-export-file/export-file-stix
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-export-file-stix:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-export-file-stix:latest
            docker push opencti/connector-export-file-stix:6.4.1
            docker push opencti/connector-export-file-stix:latest

      

  build_internal-import-file:
    docker:
      - image: cimg/base:stable-20.04
    steps:
      - checkout
      
      - run:
          name: Build internal-import-file/import-file-stix
          command: |
            echo "Processing internal-import-file/import-file-stix"
            cd internal-import-file/import-file-stix
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-import-file-stix:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-import-file-stix:latest
            docker push opencti/connector-import-file-stix:6.4.1
            docker push opencti/connector-import-file-stix:latest

      
      - run:
          name: Build internal-import-file/import-file-misp
          command: |
            echo "Processing internal-import-file/import-file-misp"
            cd internal-import-file/import-file-misp
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-import-file-misp:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-import-file-misp:latest
            docker push opencti/connector-import-file-misp:6.4.1
            docker push opencti/connector-import-file-misp:latest

      
      - run:
          name: Build internal-import-file/import-document
          command: |
            echo "Processing internal-import-file/import-document"
            cd internal-import-file/import-document
            echo "$DOCKERHUB_PASS" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin
            docker build -t opencti/connector-import-document:6.4.1 . --build-arg BASE_IMAGE=renizmy/opencti-base:6.4.1 && docker tag opencti/connector-import-document:latest
            docker push opencti/connector-import-document:6.4.1
            docker push opencti/connector-import-document:latest

      


workflows:
  version: 2
  build_all:
    jobs:
    
      - build_external-import
    
      - build_stream
    
      - build_internal-export-file
    
      - build_internal-import-file
    